for i = 1:300
    phix = diff(phil(:,i))./diff(x);
    phi_x{i} = phix;
end

for i = 1:5000
    phit = diff(phil(i,:))./diff(t);
    phi_t{i} = phit;
end
%%
phil_x = cell2mat(phi_x);
phi_t = phi_t';
phil_t = cell2mat(phi_t);
phil_y = phil_x;
%%
numb = 1.5e3;
phi_t_PDEFIND = -0.745.*phil(numb,:) - 46.*u(numb,:).^2 + 22.85.*phil(numb,:).*u(numb,:) + 0.78.*phil(numb,:).^2 + 0.05.*phil(numb,:).*phil_x((numb-1),:) - 0.0735.*phil(numb,:).^2.*phil_x((numb-1),:);
phi_t_PDEFIND = -0.745.*phil(numb,:) - 46.*u(numb,:).^2 + 22.85.*phil(numb,:).*u(numb,:) + 0.78.*phil(numb,:).^2 + 0.05.*phil(numb,:).*phil_x((numb),:) - 0.0735.*phil(numb,:).^2.*phil_x((numb),:);

%%

phi_t_PDEFIND = (-0.015744 +0.000000i)...
    + (-0.004733 +0.000000i).*phil_x((numb-1),:)...
    + (-0.011615 +0.000000i).*phil_y((numb-1),:)...
    + (-47.507756 +0.000000i).*v(numb,:)...
    + (-0.856322 +0.000000i).*u(numb,:)...
    + (0.297399 +0.000000i).*phil(numb,:)...
    + (0.596334 +0.000000i).*v(numb,:).*phil_x((numb-1),:)...
    + (0.161284 +0.000000i).*u(numb,:).*phil_x((numb-1),:)...
    + (0.011335 +0.000000i).*phil(numb,:).*phil_x((numb-1),:)...
    + (-8.363550 +0.000000i).*v(numb,:).*phil_y((numb-1),:)...
    + (0.390295 +0.000000i).*u(numb,:).*phil_y((numb-1),:)...
    + (0.020050 +0.000000i).*phil(numb,:).*phil_y((numb-1),:);

phi_x_PDEFIND = (-0.015744 +0.000000i)...
    + (-0.004733 +0.000000i).*phil_x(:,(numb))...
    + (-0.011615 +0.000000i).*phil_y(:,(numb))...
    + (-47.507756 +0.000000i).*v(2:end,numb)...
    + (-0.856322 +0.000000i).*u(2:end,numb)...
    + (0.297399 +0.000000i).*phil(2:end,numb)...
    + (0.596334 +0.000000i).*v(2:end,numb).*phil_x(:,(numb))...
    + (0.161284 +0.000000i).*u(2:end,numb).*phil_x(:,(numb))...
    + (0.011335 +0.000000i).*phil(2:end,numb).*phil_x(:,(numb))...
    + (-8.363550 +0.000000i).*v(2:end,numb).*phil_y(:,(numb))...
    + (0.390295 +0.000000i).*u(2:end,numb).*phil_y(:,(numb))...
    + (0.020050 +0.000000i).*phil(2:end,numb).*phil_y(:,(numb));

%%

numb = 100;
phi_t_PDEFIND = (-0.001626 +0.000000i)...
    + (21458523498.147430 +0.000000i).*phil_x((numb-1),:)...
    + (-21458523498.156300 +0.000000i).*phil_y((numb-1),:)...
    + (-2.404169 +0.000000i).*v(numb,:)...
    + (0.011519 +0.000000i).*phil(numb,:)...
    + (4563910426340.267578 +0.000000i).*v(numb,:).*phil_x((numb-1),:)...
    + (-393376287666.014282 +0.000000i).*u(numb,:).*phil_x((numb-1),:)...
    + (6824482170.983065 +0.000000i).*phil(numb,:).*phil_x((numb-1),:)...
    + (-4563910426346.929688 +0.000000i).*v(numb,:).*phil_y((numb-1),:)...
    + (393376287666.197205 +0.000000i).*u(numb,:).*phil_y((numb-1),:)...
    + (-6824482170.971704 +0.000000i).*phil(numb,:).*phil_y((numb-1),:);

phi_x_PDEFIND = (-0.001626 +0.000000i)...
    + (21458523498.147430 +0.000000i).*phil_x(:,numb)...
    + (-21458523498.156300 +0.000000i).*phil_y(:,numb)...
    + (-2.404169 +0.000000i).*v(2:end,numb)...
    + (0.011519 +0.000000i).*phil(2:end,numb)...
    + (4563910426340.267578 +0.000000i).*v(2:end,numb).*phil_x(:,numb)...
    + (-393376287666.014282 +0.000000i).*u(2:end,numb).*phil_x(:,numb)...
    + (6824482170.983065 +0.000000i).*phil(2:end,numb).*phil_x(:,numb)...
    + (-4563910426346.929688 +0.000000i).*v(2:end,numb).*phil_y(:,numb)...
    + (393376287666.197205 +0.000000i).*u(2:end,numb).*phil_y(:,numb)...
    + (-6824482170.971704 +0.000000i).*phil(2:end,numb).*phil_y(:,numb);

% phi_t_PDEFIND = 0.301735.*phil(numb,:) - 1.509419.*u(numb,:) + 0.015464.*phil(numb,:).*phil_y((numb-1),:);

plot(phil_t(numb,:))
hold on
plot(phi_t_PDEFIND)
    